{% extends 'base.html.twig' %}
{% block title %}{% endblock %}

{% block body %}

<div class="header">
	<img style="display: block !important;margin: auto !important;" id="logotop" src="{{ img }}">
</div>

<div class="head">
	{{ typedemande }}
</div>
<div class="nomSalon">
	{% if is_granted('ROLE_ADMIN') or is_granted('ROLE_COORDINATEUR') %}
			{{ app.session.get('nomSalon') }}
	{% elseif is_granted('ROLE_JURIDIQUE') %}
			{{ "suivi_demandes.serviceJuridique"|trans({}, "translator") }}
	{% elseif is_granted('ROLE_PAIE') %}
			{{ "suivi_demandes.servicePaie"|trans({}, "translator") }}
	{% endif %}
</div>
<div class="container">
	<div id="wrapperForm" class="row">
		{{ detail |raw }}


		{% if is_granted('ROLE_PAIE') or is_granted('ROLE_JURIDIQUE')  and  statut != 0 %}
		<div class="" style="max-width: 100%; margin: auto;width: 1000px;">
			<hr id="separatorDetailDemande"/>

			{% form_theme form2 'form/demande_complexe.html.twig' %}
			{{ form_start(form2, {'attr': {'id':'form_message','novalidate': 'novalidate'}}) }}

			{% for flash_message in app.session.flashBag.get('error') %}
				<em id="" class="error help-block">{{ flash_message }}</em>
			{% endfor %}


			{{ form_end(form2) }}

		</div>
		{% endif  %}
		<hr id="separatorDetailDemande"/>

		<div class="col-sm-12" style="padding: 0;width: 1000px;margin: auto;">
			<button  onclick="window.location.href ='{{ path("demande") }}'" class="btn-black precedent">{{ "global.back"|trans({}, "translator") }}</button>
		</div>
	</div>
</div>


<script language="javascript">
	$('.closeAlert').bind('click', function(){
		$(".alert").css('display','none');
		$(".alert").remove();
	});

	$('#demande_complexe_reject').on('click', function(){

		$('#demande_complexe_message').rules('add', {required:true});
		$('#demande_complexe_message').prop('required', true)
	});


	$( "#form_message" ).validate( {
	  rules: {
	    '#demande_complexe_docService' : {
	      required: true,
	    },
			'#demande_complexe_docSalon' : {
				required: true,
			}
	  },
	  messages: {

		},
		errorElement: "em",
	  errorPlacement: function ( error, element ) {
			// Add the `help-block` class to the error element
			error.addClass( "help-block" );

			// Add `has-feedback` class to the parent div.form-group
			// in order to add icons to inputs
			element.parents( ".col-sm-5" ).addClass( "has-feedback" );



	    if ( element.prop( "type" ) === "checkbox" ) {
	      error.insertAfter( element.parent( "label" ) );
	    } else if( element.prop( "type" ) === "select-one" || element.prop( "type" ) === "radio") {
	      error.appendTo( element.parent());
	    } else {
	      error.insertAfter( element );
	    }

			// Add the span element, if doesn't exists, and apply the icon classes to it.
			if ( !element.next( "span" )[ 0 ] ) {
				$( "<span class='glyphicon glyphicon-remove form-control-feedback'></span>" ).insertAfter( element );
			}
		},
		success: function ( label, element ) {
			// Add the span element, if doesn't exists, and apply the icon classes to it.
			if ( !$( element ).next( "span" )[ 0 ] ) {
				$( "<span class='glyphicon glyphicon-ok form-control-feedback'></span>" ).insertAfter( $( element ) );
			}
		},
		highlight: function ( element, errorClass, validClass ) {
			$( element ).parents( ".col-sm-5" ).addClass( "has-error" ).removeClass( "has-success" );
			$( element ).next( "span" ).addClass( "glyphicon-remove" ).removeClass( "glyphicon-ok" );
		},
		unhighlight: function ( element, errorClass, validClass ) {
			$( element ).parents( ".col-sm-5" ).addClass( "has-success" ).removeClass( "has-error" );
			$( element ).next( "span" ).addClass( "glyphicon-ok" ).removeClass( "glyphicon-remove" );
		}
	});
</script>
{% endblock %}
